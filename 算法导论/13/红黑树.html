<script type="text/javascript">

	var t = {};
	t.nil = {};
	t.root = t.nil;
	var a = [];
	console.log(a);
	var n = 10;
	for(var i = 0; i < n; i++){
		var k = Math.floor(Math.random()*n);
		a.push(k);
		console.log('插入：',k);
		rbInsert(t, {key: k});
	}
	console.log(t);
	console.log("中序遍历：");
	inOrderTreeWalk(t.root);

	function inOrderTreeWalk(x){
		if(x != t.nil){
			inOrderTreeWalk(x.left);
			console.log(x.key);
			inOrderTreeWalk(x.right);
		}
	}

	function preOrderTreeWalk(x){
		if(x != t.nil){
			console.log(x.key);
			preOrderTreeWalk(x.left);
			preOrderTreeWalk(x.right);
		}
	}

	function postOrderTreeWalk(x){
		if(x != t.nil){
			postOrderTreeWalk(x.left);
			postOrderTreeWalk(x.right);
			console.log(x.key);
		}
	}

	function leftRotate(t, x){
		var y = x.right;
		x.right = y.left;
		if(y.left!=t.nil){
			y.left.parent = x;
		}
		y.parent = x.parent;
		if(x.parent == t.nil){
			t.root = y;
		} else if(x == x.parent.left){
			x.parent.left = y;
		} else {
			x.parent.right = y;
		}
		y.left = x;
		x.parent = y;
	}

	function rightRotate(t, y){
		var x = y.left;
		y.left = x.right;
		if(x.right!=t.nil){
			x.right.parent = y;
		}
		x.parent = y.parent;
		if(y.parent == t.nil){
			t.root = x;
		} else if(y == y.parent.left){
			y.parent.left = x;
		} else {
			y.parent.right = x;
		}
		x.right = y;
		y.parent = x;
	}

	function rbInsert(t, z){
		var y = t.nil;
		var x = t.root;
		while(x!=t.nil){
			y = x;
			if(z.key < x.key){
				x = x.left;
			} else {
				x = x.right;
			}
		}
		z.parent = y;
		if(y == t.nil){
			t.root = z;
		} else if(z.key < y.key){
			y.left = z;
		} else {
			y.right = z;
		}
		z.left = t.nil;
		z.right = t.nil;
		z.color = 'red';
		rbInsertFixUp(t, z);
	}

	function rbInsertFixUp(t, z){
		while(z.parent.color=='red'){
			if(z.parent == z.parent.parent.left){
				var y = z.parent.parent.right;
				if(y.color=='red'){
					z.parent.color = 'black';
					y.color = 'black';
					z.parent.parent.color = 'red';
					z = z.parent.parent;
				} else{
					if(z == z.parent.right){
						z = z.parent;
						leftRotate(t, z);
					}
					z.parent.color = 'black';
					z.parent.parent.color = 'red';
					rightRotate(t, z.parent.parent);
				}
			} else {
				var y = z.parent.parent.left;
				if(y.color = 'red'){
					z.parent.color = 'black';
					y.color = 'black';
					z.parent.parent.color = 'red';
					z = z.parent.parent;
				} else {
					if(z == z.parent.left){
						z = z.parent;
						rightRotate(t, z);
					}
					z.parent.color = 'black';
					z.parent.parent.color = 'red';
					leftRotate(t, z.parent.parent);
				}
			}
		}
		t.root.color = 'black';
	}

	function rbTransplant(t, u, z){
		if(u.p==t.nil){
			t.root = v;
		} else if(u==u.parent.left){
			u.parent.left = v;
		} else {
			u.parent.right = v;
		}
		v.p = u.p;
	}

	function treeMinimum(x){
		while(x.left){
			x = x.left;
		}
		return x;
	}

	function treeMaximum(x){
		while(x.right){
			x = x.right;
		}
		return x;
	}

	function rbDelete(t, x){
		var y = z;
		y.originalColor = y.color;
		if(z.left == t.nil){
			x = z.right;
			rbTransplant(t, z, z.right);
		} else if(z.right == t.nil){
			x = z.left;
			rbTransplant(t, z, z.left);
		} else {
			y = treeMinimum(z.right);
			y.originalColor = y.color;
			x = y.right;
			if(y.parent == z){
				x.parent = y;
			} else {
				rbTransplant(t, y, y.right);
				y.right = z.right;
				y.right.parent = y;
			}
			rbTransplant(t, z, y);
			y.left = z.left;
			y.left.parent = y;
			y.color = z.color;
		}
		if(y.originalColor == 'black'){
			rbDeleteFixUp(t, x);
		}
	}

	function rbDeleteFixUp(t, x){
		while(x!=t.root && x.color=='black'){
			if(x == x.parent.left){
				var w = x.parent.right;
				if(w.color=='red'){
					w.color = 'black';
					x.parent.color = 'red';
					leftRotate(t, x.parent);
					w = x.parent.right;
				}
				if(w.left.color == 'black' && w.right.color == 'black'){
					w.color = 'red';
					x = x.parent;
				} else{
					if(w.right.color == 'black'){
						w.left.color = 'black';
						w.color = 'red';
						rightRotate(t, w);
						w = x.parent.right;
					}
					w.color = x.parent.color;
					x.parent.color = 'black';
					w.right.color = 'black';
					leftRotate(t, x.parent);
					x = t.root;
				}
			} else {

			}
		}
		x.color = 'black';
	}
</script>






